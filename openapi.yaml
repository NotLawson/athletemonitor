openapi: 3.0.0
info:
  title: ADP Athlete Monitor API
  description: API for the ADP Athlete Monitor.
  version: 0.0.1
  contact:
    name: Lawson Conallin
    email: 011874@wmac.com.au

servers:
  - url: http://localhost/api
    description: Main Production Server
  - url: http://localhost:8080
    description: Local Development Server

paths:
  /:
    get:
      summary: Root endpoint
      description: Returns a basic response for the root endpoint.
      tags:
        - web_server.py
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    example: ok

  /response_test/{response_code}:
    get:
      summary: Response test endpoint
      description: Returns a response based on the provided response code.
      tags:
        - web_server.py
      parameters:
        - name: response_code
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK

  /auth/authorize:
    post:
      summary: Authorize user
      description: Authorize a user with username and password.
      tags:
        - auth.py
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: OK
        '401':
          description: Unauthorized

  /auth/authenticate:
    get:
      summary: Authenticate user
      description: Validate a JWT and return user info.
      tags:
        - auth.py
      parameters:
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
          description: Bearer token (e.g. "Bearer <token>")
      responses:
        '200':
          description: OK
        '401':
          description: Unauthorized

  /auth/register:
    post:
      summary: Register user
      description: Register a new user.
      tags:
        - auth.py
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
                pname:
                  type: string
                fname:
                  type: string
                lname:
                  type: string
                email:
                  type: string
                type:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Bad Request

  /logs/{log_id}:
    get:
      summary: Get log
      description: Retrieve a log by its ID.
      tags:
        - logs.py
      parameters:
        - name: log_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    delete:
      summary: Delete log
      description: Delete a log by its ID.
      tags:
        - logs.py
      parameters:
        - name: log_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content
    patch:
      summary: Update log
      description: Update a log by its ID.
      tags:
        - logs.py
      parameters:
        - name: log_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /logs:
    get:
      summary: Filter logs
      description: Filter logs based on query parameters.
      tags:
        - logs.py
      security:
        - BearerAuth: []
      parameters:
        - name: user_id
          in: query
          required: false
          schema:
            type: integer
        - name: date
          in: query
          required: false
          schema:
            type: string
        - name: log_type
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: OK
    put:
      summary: Create log
      description: Create a new log entry.
      tags:
        - logs.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Created
    delete:
      summary: Delete logs by filter
      description: Delete logs based on filter criteria. (Admin only)
      tags:
        - logs.py
      parameters:
        - name: user_id
          in: query
          required: false
          schema:
            type: integer
        - name: date
          in: query
          required: false
          schema:
            type: string
        - name: log_type
          in: query
          required: false
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

  /admin/sync/users:
    get:
      summary: Sync users
      description: Sync users from external system.
      tags:
        - admin.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /iden/user:
    get:
      summary: Get all users
      description: Retrieve a list of all users.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    post:
      summary: Create user
      description: Create a new user.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
                pname:
                  type: string
                fname:
                  type: string
                lname:
                  type: string
                email:
                  type: string
                type:
                  type: string
      responses:
        '201':
          description: Created

  /iden/user/{user_id}:
    get:
      summary: Get user details
      description: Retrieve user details by user ID.
      tags:
        - iden.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
        '404':
          description: Not Found
    patch:
      summary: Update user details
      description: Update user details by user ID.
      tags:
        - iden.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
    delete:
      summary: Delete user
      description: Delete a user by user ID.
      tags:
        - iden.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

  /iden/user/me:
    get:
      summary: Get own details
      description: Retrieve details of the authenticated user.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    patch:
      summary: Update own details
      description: Update details of the authenticated user.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /iden/groups:
    get:
      summary: Get all groups
      description: Retrieve a list of all groups.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /iden/group:
    post:
      summary: Create group
      description: Create a new group.
      tags:
        - iden.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: Created

  /iden/group/{group_id}:
    get:
      summary: Get group details
      description: Retrieve group details by group ID.
      tags:
        - iden.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    patch:
      summary: Update group
      description: Update group details by group ID.
      tags:
        - iden.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
    delete:
      summary: Delete group
      description: Delete a group by group ID.
      tags:
        - iden.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

  /activities/schedule/{schedule_id}:
    get:
      summary: Get schedule
      description: Retrieve a schedule by its ID.
      tags:
        - activities.py
      parameters:
        - name: schedule_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    patch:
      summary: Update schedule
      description: Update a schedule by its ID.
      tags:
        - activities.py
      parameters:
        - name: schedule_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
    delete:
      summary: Delete schedule
      description: Delete a schedule by its ID.
      tags:
        - activities.py
      parameters:
        - name: schedule_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

  /activities/schedule:
    put:
      summary: Create schedule
      description: Create a new schedule.
      tags:
        - activities.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
      responses:
        '201':
          description: Created

  /activities/schedule/user/{user_id}:
    get:
      summary: Get schedules for user
      description: Retrieve all schedules for a specific user.
      tags:
        - activities.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /activities/schedule/me:
    get:
      summary: Get my schedules
      description: Retrieve all schedules for the authenticated user.
      tags:
        - activities.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /activities/activity/{activity_id}:
    get:
      summary: Get activity
      description: Retrieve an activity by its ID.
      tags:
        - activities.py
      parameters:
        - name: activity_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK
    patch:
      summary: Update activity
      description: Update an activity by its ID.
      tags:
        - activities.py
      parameters:
        - name: activity_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK
    delete:
      summary: Delete activity
      description: Delete an activity by its ID.
      tags:
        - activities.py
      parameters:
        - name: activity_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

  /activities/activity:
    put:
      summary: Create activity
      description: Create a new activity.
      tags:
        - activities.py
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
      responses:
        '201':
          description: Created

  /activities/activity/schedule/{schedule_id}:
    get:
      summary: Get activities by schedule
      description: Retrieve all activities for a specific schedule.
      tags:
        - activities.py
      parameters:
        - name: schedule_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /activities/activity/user/{user_id}:
    get:
      summary: Get activities by user
      description: Retrieve all activities for a specific user.
      tags:
        - activities.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /activities/activity/me:
    get:
      summary: Get my activities
      description: Retrieve all activities for the authenticated user.
      tags:
        - activities.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/individual/{user_id}:
    get:
      summary: Get individual stats
      description: Retrieve performance stats for an individual user.
      tags:
        - stats.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/individual/{user_id}/{field}:
    get:
      summary: Get individual stats field
      description: Retrieve specific field performance stats for an individual user.
      tags:
        - stats.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
        - name: field
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/individual/me:
    get:
      summary: Get my individual stats
      description: Retrieve performance stats for the authenticated user.
      tags:
        - stats.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/individual/me/{field}:
    get:
      summary: Get my individual stats field
      description: Retrieve specific field performance stats for the authenticated user.
      tags:
        - stats.py
      parameters:
        - name: field
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/group/{group_id}:
    get:
      summary: Get group stats
      description: Retrieve performance stats for a group.
      tags:
        - stats.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/group/{group_id}/{field}:
    get:
      summary: Get group stats field
      description: Retrieve specific field performance stats for a group.
      tags:
        - stats.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
        - name: field
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/org:
    get:
      summary: Get organization stats
      description: Retrieve organization-wide performance stats.
      tags:
        - stats.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/org/{field}:
    get:
      summary: Get organization stats field
      description: Retrieve specific field organization-wide performance stats.
      tags:
        - stats.py
      parameters:
        - name: field
          in: path
          required: true
          schema:
            type: string
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/export:
    get:
      summary: Export stats
      description: Export stats data.
      tags:
        - stats.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/streaks/{user_id}:
    get:
      summary: Get user streaks
      description: Retrieve streaks for a user.
      tags:
        - stats.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/streaks/me:
    get:
      summary: Get my streaks
      description: Retrieve streaks for the authenticated user.
      tags:
        - stats.py
      security:
        - BearerAuth: []
      responses:
        '200':
          description: OK

  /stats/streaks/freeze/user/{user_id}:
    post:
      summary: Freeze user streak
      description: Freeze streak for a user, either until specified date or indefinitely.
      tags:
        - stats.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /stats/streaks/freeze/group/{group_id}:
    post:
      summary: Freeze group streak
      description: Freeze streak for a group, either until specified date or indefinitely.
      tags:
        - stats.py
      parameters:
        - name: group_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /stats/streaks/freeze/deepfreeze:
    post:
      summary: Freeze org streak
      description: Freeze streak for the entire organization.
      tags:
        - stats.py
      security:
        - BearerAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: OK

  /stats/reset/{user_id}:
    delete:
      summary: Reset user stats
      description: Reset stats for a user. (Admin only)
      tags:
        - stats.py
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
      security:
        - BearerAuth: []
      responses:
        '204':
          description: No Content

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

# Note: operation-level security is used above for endpoints that require authentication.